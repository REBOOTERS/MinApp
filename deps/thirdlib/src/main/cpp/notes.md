## std vector

å½“ç„¶å¯ä»¥ ğŸ‘
ä¸‹é¢æ˜¯å¯¹ **C++ `std::vector`** çš„ç³»ç»Ÿè®²è§£ï¼ŒåŒ…æ‹¬å¸¸è§ç”¨æ³•ã€åº•å±‚åŸç†å’Œæ³¨æ„äº‹é¡¹ã€‚

---

## ğŸ§© ä¸€ã€`std::vector` æ˜¯ä»€ä¹ˆï¼Ÿ

`std::vector` æ˜¯ C++ STLï¼ˆæ ‡å‡†æ¨¡æ¿åº“ï¼‰ä¸­çš„**åŠ¨æ€æ•°ç»„å®¹å™¨**ï¼Œå¯ä»¥è‡ªåŠ¨ç®¡ç†å†…å­˜å¤§å°ï¼Œæ”¯æŒéšæœºè®¿é—®ã€åŠ¨æ€æ‰©å®¹ã€æ’å…¥åˆ é™¤ç­‰æ“ä½œã€‚
å®ƒå®šä¹‰åœ¨å¤´æ–‡ä»¶ï¼š

```cpp
#include <vector>
```

---

## ğŸ—ï¸ äºŒã€åŸºæœ¬å®šä¹‰ä¸åˆå§‹åŒ–

```cpp
#include <vector>
#include <iostream>
using namespace std;

int main() {
    // 1. ç©º vector
    vector<int> v1;

    // 2. åˆå§‹åŒ–å¤§å°ï¼ˆå…ƒç´ é»˜è®¤åˆå§‹åŒ–ä¸º0ï¼‰
    vector<int> v2(5); // [0,0,0,0,0]

    // 3. åˆå§‹åŒ–å¤§å°å’Œé»˜è®¤å€¼
    vector<int> v3(5, 10); // [10,10,10,10,10]

    // 4. åˆ—è¡¨åˆå§‹åŒ–
    vector<int> v4 = {1, 2, 3, 4, 5};

    // 5. æ‹·è´æ„é€ 
    vector<int> v5(v4);

    // 6. ä½¿ç”¨è¿­ä»£å™¨æ„é€ 
    vector<int> v6(v4.begin() + 1, v4.end()); // [2,3,4,5]
}
```

---

## âš™ï¸ ä¸‰ã€å¸¸ç”¨æ“ä½œå‡½æ•°

### 1ï¸âƒ£ å¢åŠ å…ƒç´ 

```cpp
v.push_back(10);    // æœ«å°¾æ·»åŠ å…ƒç´ 
v.emplace_back(20); // æœ«å°¾åŸåœ°æ„é€ å…ƒç´ ï¼ˆæ€§èƒ½æ›´å¥½ï¼‰
```

### 2ï¸âƒ£ è®¿é—®å…ƒç´ 

```cpp
int x = v[0];          // ä¸æ£€æŸ¥è¶Šç•Œ
int y = v.at(1);       // æ£€æŸ¥è¶Šç•Œï¼Œè¶Šç•ŒæŠ›å¼‚å¸¸
int first = v.front(); // ç¬¬ä¸€ä¸ªå…ƒç´ 
int last = v.back();   // æœ€åä¸€ä¸ªå…ƒç´ 
```

### 3ï¸âƒ£ åˆ é™¤å…ƒç´ 

```cpp
v.pop_back();                 // åˆ é™¤æœ€åä¸€ä¸ª
v.erase(v.begin() + 2);       // åˆ é™¤å•ä¸ªå…ƒç´ 
v.erase(v.begin(), v.begin()+3); // åˆ é™¤åŒºé—´
v.clear();                    // æ¸…ç©ºå…¨éƒ¨
```

### 4ï¸âƒ£ æ’å…¥å…ƒç´ 

```cpp
v.insert(v.begin(), 100);              // åœ¨å¼€å¤´æ’å…¥
v.insert(v.begin()+2, 3, 9);           // æ’å…¥3ä¸ª9
v.emplace(v.begin()+1, 42);            // åŸåœ°æ„é€ æ’å…¥
```

### 5ï¸âƒ£ å¤§å°ä¸å®¹é‡ç®¡ç†

```cpp
v.size();       // å½“å‰å…ƒç´ æ•°
v.capacity();   // å½“å‰åˆ†é…çš„å†…å­˜å®¹é‡
v.empty();      // æ˜¯å¦ä¸ºç©º

v.resize(10);        // æ”¹å˜å¤§å°ï¼ˆå¯èƒ½å¡«å……0ï¼‰
v.reserve(100);      // æå‰åˆ†é…å®¹é‡ï¼Œé¿å…é¢‘ç¹æ‰©å®¹
v.shrink_to_fit();   // æ”¶ç¼©å®¹é‡è‡³sizeå¤§å°
```

---

## ğŸ§­ å››ã€è¿­ä»£å™¨ä½¿ç”¨

```cpp
for (vector<int>::iterator it = v.begin(); it != v.end(); ++it)
    cout << *it << " ";

for (auto it = v.begin(); it != v.end(); ++it)
    cout << *it << " ";

for (auto &x : v)
    cout << x << " ";
```

---

## âš¡ äº”ã€åº•å±‚æœºåˆ¶

* **è¿ç»­å†…å­˜**ï¼šä¸æ™®é€šæ•°ç»„ç±»ä¼¼ï¼Œ`vector` å…ƒç´ å­˜æ”¾åœ¨ä¸€å—è¿ç»­çš„å†…å­˜ä¸­ã€‚
* **åŠ¨æ€æ‰©å®¹**ï¼šå½“å®¹é‡ä¸è¶³æ—¶ï¼Œé€šå¸¸æŒ‰ **2 å€ç­–ç•¥** é‡æ–°åˆ†é…æ›´å¤§çš„å†…å­˜ï¼Œå¹¶å¤åˆ¶æ—§æ•°æ®ã€‚
* **æŒ‡é’ˆ/è¿­ä»£å™¨å¤±æ•ˆ**ï¼šæ‰©å®¹æˆ–åˆ é™¤å…ƒç´ å¯èƒ½å¯¼è‡´åŸæœ‰çš„æŒ‡é’ˆã€è¿­ä»£å™¨ã€å¼•ç”¨å¤±æ•ˆã€‚

---

## ğŸ§  å…­ã€å¸¸è§æŠ€å·§ä¸æ³¨æ„äº‹é¡¹

1. **é¿å…é¢‘ç¹æ‰©å®¹**
   è‹¥èƒ½é¢„ä¼°å…ƒç´ æ•°é‡ï¼Œä½¿ç”¨ `reserve(n)` æå‰åˆ†é…å†…å­˜ï¼Œå¯æ˜¾è‘—æå‡æ€§èƒ½ã€‚

2. **å°å¿ƒè¿­ä»£å™¨å¤±æ•ˆ**

    * æ’å…¥/åˆ é™¤æ“ä½œå¯èƒ½å¯¼è‡´éƒ¨åˆ†æˆ–å…¨éƒ¨è¿­ä»£å™¨å¤±æ•ˆï¼›
    * è‹¥ä¿®æ”¹åè¿˜è¦è®¿é—®åŸæ¥çš„è¿­ä»£å™¨ï¼Œè¯·é‡æ–°è·å–ã€‚

3. **å†…å­˜é‡Šæ”¾**
   `clear()` ä»…æ¸…ç©ºå…ƒç´ ï¼Œä¸é‡Šæ”¾å®¹é‡ï¼›
   è‹¥æƒ³é‡Šæ”¾å†…å­˜ï¼Œå¯ï¼š

   ```cpp
   vector<int>().swap(v);
   ```

4. **äºŒç»´ vector**

   ```cpp
   vector<vector<int>> grid(3, vector<int>(4, 0));
   ```

---

## ğŸ” ä¸ƒã€å¸¸è§éå†æ–¹å¼å¯¹æ¯”

| å†™æ³•                                   | ç‰¹ç‚¹      |
| ------------------------------------ | ------- |
| `for (int i = 0; i < v.size(); ++i)` | å¯æŒ‰ç´¢å¼•è®¿é—®  |
| `for (auto &x : v)`                  | æœ€ç®€æ´ï¼Œæ¨è  |
| `for_each(v.begin(), v.end(), func)` | é€‚åˆå‡½æ•°å¼é£æ ¼ |

---

## ğŸ“˜ å…«ã€ç¤ºä¾‹ï¼šç»¼åˆä½¿ç”¨

```cpp
#include <vector>
#include <iostream>
using namespace std;

int main() {
    vector<int> v = {1, 2, 3};
    v.push_back(4);
    v.insert(v.begin(), 0);
    v.erase(v.begin() + 2);

    cout << "size=" << v.size() << " capacity=" << v.capacity() << endl;
    for (auto x : v) cout << x << " ";
    cout << endl;
}
```

è¾“å‡ºï¼š

```
size=4 capacity=6
0 1 3 4
```

---

éå¸¸å¥½çš„é—®é¢˜ ğŸ‘
è¿™æ®µä»£ç è¡¨é¢çœ‹ç®€å•ï¼Œå…¶å®æ¶‰åŠ **C++ ç§»åŠ¨è¯­ä¹‰ï¼ˆmove semanticsï¼‰**ã€`std::move` çš„ä½œç”¨ï¼Œä»¥åŠ `emplace_back` çš„æ„é€ æ–¹å¼ã€‚
æˆ‘ä»¬é€è¡Œæ¥æ‹†è§£ğŸ‘‡

---

-----------------------vector emplace and move----------------------------

## ğŸ“˜ ä»£ç å›é¡¾

```cpp
vector<float> nums;
vector<float> results;

results.emplace_back(move(nums));
```

---

## âš ï¸ ä¸€ã€é¦–å…ˆï¼Œè¿™æ®µä»£ç æ˜¯**æœ‰é—®é¢˜çš„ï¼**

`results` æ˜¯ä¸€ä¸ª `vector<float>`ï¼Œ
ä½†ä½ åœ¨ `emplace_back(move(nums))` æ—¶ä¼ å…¥çš„æ˜¯ä¸€ä¸ª `vector<float>`ã€‚

ğŸ‘‰ ä¹Ÿå°±æ˜¯è¯´ä½ è¯•å›¾**æŠŠä¸€ä¸ª vector å½“æˆä¸€ä¸ª float æ’å…¥åˆ°å¦ä¸€ä¸ª vector é‡Œ**ã€‚
è¿™ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼š

```
error: no matching function for call to â€˜std::vector<float>::emplace_back(std::vector<float>)â€™
```

å¦‚æœä½ çš„æ„å›¾æ˜¯ï¼š

* æŠŠ `nums` è¿™ä¸ªæµ®ç‚¹æ•°ç»„æ•´ä½“æ·»åŠ åˆ°ä¸€ä¸ªæ›´å¤§çš„â€œæ•°ç»„åˆ—è¡¨â€ä¸­ï¼Œ
  é‚£ä¹ˆç±»å‹åº”å½“æ˜¯ï¼š

```cpp
vector<vector<float>> results;
results.emplace_back(move(nums)); // âœ… æ­£ç¡®
```

---

## ğŸ§© äºŒã€`std::move(nums)` çš„ä½œç”¨

`std::move` å¹¶ä¸ä¼šç§»åŠ¨å¯¹è±¡ï¼Œå®ƒåªæ˜¯**æŠŠä¸€ä¸ªå·¦å€¼ï¼ˆå…·åå˜é‡ï¼‰è½¬æ¢ä¸ºå³å€¼å¼•ç”¨**ï¼Œ
ä»è€Œè§¦å‘**ç§»åŠ¨è¯­ä¹‰ï¼ˆmove semanticsï¼‰**ã€‚

ç®€å•è¯´ï¼š

```cpp
std::move(nums)
```

å‘Šè¯‰ç¼–è¯‘å™¨ï¼šâ€œæˆ‘ä¸å†éœ€è¦ `nums` é‡Œçš„æ•°æ®ï¼Œä½ å¯ä»¥ç›´æ¥â€˜å·èµ°â€™å®ƒçš„èµ„æºâ€ã€‚

---

## âš™ï¸ ä¸‰ã€`emplace_back` åšäº†ä»€ä¹ˆï¼Ÿ

å½“æˆ‘ä»¬å†™ï¼š

```cpp
results.emplace_back(move(nums));
```

æ—¶ï¼š

1. `move(nums)` å°† `nums` è½¬ä¸ºå³å€¼å¼•ç”¨ï¼›
2. `emplace_back()` è°ƒç”¨ `vector<float>` çš„**ç§»åŠ¨æ„é€ å‡½æ•°**ï¼ˆ`vector(vector&&)`ï¼‰ï¼›
3. å†…éƒ¨ç›´æ¥â€œçªƒå–â€äº† `nums` çš„å†…å­˜æŒ‡é’ˆï¼›
4. è¿™æ ·é¿å…äº†æ·±æ‹·è´ï¼Œæé«˜æ•ˆç‡ã€‚

æ­¤æ—¶ï¼š

* `nums` å˜æˆäº†ä¸€ä¸ªâ€œç©ºå£³â€ï¼Œ`size()==0`ï¼Œä½†å¤„äºæœ‰æ•ˆçŠ¶æ€ï¼›
* `results` ä¸­çš„æ–°å…ƒç´ æ‹¥æœ‰åŸå…ˆ `nums` çš„æ•°æ®ã€‚

---

## ğŸ§  å››ã€ä¸ºä»€ä¹ˆä¸ç”¨æ™®é€šèµ‹å€¼ï¼Ÿ

å¯¹æ¯”çœ‹çœ‹ä¸¤ç§å†™æ³•ï¼š

```cpp
results.emplace_back(nums);         // âŒ æ‹·è´æ•´ä¸ª numsï¼Œæ€§èƒ½è¾ƒå·®
results.emplace_back(std::move(nums)); // âœ… ç›´æ¥è½¬ç§»èµ„æºï¼Œæ— éœ€æ‹·è´
```

### æ‹·è´æ„é€ ï¼ˆcopy constructorï¼‰

ä¼šå¤åˆ¶ `nums` ä¸­æ‰€æœ‰æ•°æ®ã€‚

### ç§»åŠ¨æ„é€ ï¼ˆmove constructorï¼‰

åªç§»åŠ¨å†…éƒ¨æŒ‡é’ˆï¼Œä¸å¤åˆ¶æ•°æ®ï¼Œå‡ ä¹é›¶æˆæœ¬ã€‚

---

## ğŸ§® äº”ã€æ€»ç»“

| å†™æ³•                                      | å«ä¹‰     | æ˜¯å¦æ‹·è´æ•°æ®     | nums çŠ¶æ€  |
| --------------------------------------- | ------ | ---------- | -------- |
| `results.emplace_back(nums)`            | è°ƒç”¨æ‹·è´æ„é€  | âœ… æ˜¯        | ä¿ç•™æ•°æ®     |
| `results.emplace_back(std::move(nums))` | è°ƒç”¨ç§»åŠ¨æ„é€  | âŒ å¦ï¼ˆåªè½¬ç§»æŒ‡é’ˆï¼‰ | è¢«æ¸…ç©ºï¼ˆä½†å¯ç”¨ï¼‰ |

---

## âœ… å…­ã€æ­£ç¡®ç¤ºä¾‹ï¼ˆåµŒå¥— vectorï¼‰

```cpp
#include <vector>
#include <iostream>
using namespace std;

int main() {
    vector<float> nums = {1.0, 2.0, 3.0};
    vector<vector<float>> results;

    results.emplace_back(move(nums));

    cout << "nums.size() = " << nums.size() << endl;      // 0
    cout << "results[0].size() = " << results[0].size() << endl; // 3
}
```

è¾“å‡ºï¼š

```
nums.size() = 0
results[0].size() = 3
```

---

æ˜¯å¦å¸Œæœ›æˆ‘æ¥ä¸‹æ¥è®²ä¸€ä¸‹ï¼š

* ğŸ” `move()` èƒŒåçš„**å³å€¼å¼•ç”¨æœºåˆ¶**å’Œ**ç§»åŠ¨æ„é€ å‡½æ•°åŸç†**ï¼Ÿ
* è¿˜æ˜¯å¸Œæœ›æˆ‘ç”¨å›¾ç¤ºè®²æ¸…æ¥š vector å†…éƒ¨æŒ‡é’ˆåœ¨ move å‰åçš„å˜åŒ–ï¼Ÿ

